<?xml version="1.0" encoding="utf-8"?>
<!--
 ! CDDL HEADER START
 !
 ! The contents of this file are subject to the terms of the
 ! Common Development and Distribution License, Version 1.0 only
 ! (the "License").  You may not use this file except in compliance
 ! with the License.
 !
 ! You can obtain a copy of the license at
 ! trunk/opends/resource/legal-notices/OpenDS.LICENSE
 ! or https://OpenDS.dev.java.net/OpenDS.LICENSE.
 ! See the License for the specific language governing permissions
 ! and limitations under the License.
 !
 ! When distributing Covered Code, include this CDDL HEADER in each
 ! file and include the License file at
 ! trunk/opends/resource/legal-notices/OpenDS.LICENSE.  If applicable,
 ! add the following below this CDDL HEADER, with the fields enclosed
 ! by brackets "[]" replaced with your own identifying information:
 !      Portions Copyright [yyyy] [name of copyright owner]
 !
 ! CDDL HEADER END
 !
 !
 !      Portions Copyright 2007 Sun Microsystems, Inc.
 ! -->

<adm:managed-object name="replication-domain"
  plural-name="replication-domains"
  package="org.opends.server.admin.std"
  xmlns:adm="http://www.opends.org/admin"
  xmlns:ldap="http://www.opends.org/admin-ldap">
  <adm:synopsis>
    The
    <adm:user-friendly-name />
    is used to provide Multimaster Replication of several OpenDS copies
    of the same data
  </adm:synopsis>
  <adm:tag name="replication"/>
  <adm:profile name="ldap">
    <ldap:object-class>
      <ldap:name>ds-cfg-replication-domain</ldap:name>
      <ldap:superior>top</ldap:superior>
    </ldap:object-class>
  </adm:profile>
  <adm:property name="replication-server" multi-valued="true"
    mandatory="true">
    <adm:synopsis>
      Specifies the addresses of the replication server to which this
      <adm:user-friendly-name />
      should try to connect at startup time.
    </adm:synopsis>
    <adm:description>
      Addresses must be specified using the syntax: hostname:port
    </adm:description>
    <adm:requires-admin-action>
      <adm:none />
    </adm:requires-admin-action>
    <adm:syntax>
      <adm:string>
        <adm:pattern>
          <adm:regex>.+:[0-9]+</adm:regex>
          <adm:usage>HOST:PORT</adm:usage>
          <adm:synopsis>
            A hostname, followed by a ":" followed by a port number.
          </adm:synopsis>
        </adm:pattern>
      </adm:string>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-replication-server</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="server-id" multi-valued="false" mandatory="true"
    read-only="true">
    <adm:synopsis>
      Specifies the server ID of this multimaster provider.
    </adm:synopsis>
    <adm:description>
      Each multimaster provider must have a different server ID.
    </adm:description>
    <adm:requires-admin-action>
      <adm:none />
    </adm:requires-admin-action>
    <adm:syntax>
      <adm:integer lower-limit="1" upper-limit="65535"></adm:integer>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-server-id</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="base-dn" mandatory="true"
    multi-valued="false" read-only="true">
    <adm:synopsis>
      Specifies the base dn of the Multimaster Domain
    </adm:synopsis>
    <adm:syntax>
      <adm:dn></adm:dn>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-base-dn</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="window-size" mandatory="false"
    multi-valued="false">
    <adm:synopsis>
      Specifies the window size that this domain will use when
      communicating with replication servers.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>100</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:integer></adm:integer>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-window-size</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="heartbeat-interval" mandatory="false"
    multi-valued="false">
    <adm:synopsis>
      Specifies the heartbeat interval that this Domain must use when
      communicating with replication servers. The Domain will expect
      regular heartbeat coming from the replication server with this
      interval if they are not received it will close its connection and
      connect to another replication server.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>1000ms</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:duration base-unit="ms" allow-unlimited="false"
        lower-limit="100" />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-heartbeat-interval</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="isolation-policy" mandatory="false"
    multi-valued="false">
    <adm:synopsis>
      <adm:user-friendly-name />
      indicates the behavior of the LDAP server if an update is attempted
      when replication has been configured but none of the configured
      Replication Servers are up an running when the update is received.
    </adm:synopsis>
    <adm:default-behavior>
    	<adm:defined>
    		<adm:value>reject-all-updates</adm:value></adm:defined></adm:default-behavior>
    <adm:syntax>
      <adm:enumeration>
        <adm:value name="accept-all-updates">
          <adm:synopsis>
            Indicates that updates should be accepted even though it is
            not possible to send them to any Replication Server.
            Best effort will be made to re-send those updates to a
            Replication Servers when one of them is available, however
            those changes will be at risk because they will only be
            available from the historical information. This mode may
            also introduce high replication latency.
          </adm:synopsis>
        </adm:value>
        <adm:value name="reject-all-updates">
          <adm:synopsis>
            Indicates that all updates attempted on this replicated
            base-dn on this server when no Replication Server is
            available will be denied.
          </adm:synopsis>
        </adm:value>
      </adm:enumeration>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-isolation-policy</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
</adm:managed-object>
