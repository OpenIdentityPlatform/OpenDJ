<?xml version="1.0" encoding="utf-8"?>
<!--
  ! CDDL HEADER START
  !
  ! The contents of this file are subject to the terms of the
  ! Common Development and Distribution License, Version 1.0 only
  ! (the "License").  You may not use this file except in compliance
  ! with the License.
  !
  ! You can obtain a copy of the license at
  ! trunk/opends/resource/legal-notices/OpenDS.LICENSE
  ! or https://OpenDS.dev.java.net/OpenDS.LICENSE.
  ! See the License for the specific language governing permissions
  ! and limitations under the License.
  !
  ! When distributing Covered Code, include this CDDL HEADER in each
  ! file and include the License file at
  ! trunk/opends/resource/legal-notices/OpenDS.LICENSE.  If applicable,
  ! add the following below this CDDL HEADER, with the fields enclosed
  ! by brackets "[]" replaced with your own identifying information:
  !      Portions Copyright [yyyy] [name of copyright owner]
  !
  ! CDDL HEADER END
  !
  !
  !      Portions Copyright 2007-2008 Sun Microsystems, Inc.
  ! -->
<adm:managed-object name="replication-domain"
  plural-name="replication-domains"
  package="org.opends.server.admin.std"
  xmlns:adm="http://www.opends.org/admin"
  xmlns:ldap="http://www.opends.org/admin-ldap">
  <adm:synopsis>
    A
    <adm:user-friendly-name />
    comprises of several Directory Servers sharing the same synchronized
    set of data.
  </adm:synopsis>
  <adm:tag name="replication" />
  <adm:profile name="ldap">
    <ldap:object-class>
      <ldap:name>ds-cfg-replication-domain</ldap:name>
      <ldap:superior>top</ldap:superior>
    </ldap:object-class>
  </adm:profile>
  <adm:property name="replication-server" multi-valued="true"
    mandatory="true">
    <adm:synopsis>
      Specifies the addresses of the Replication Servers within the
      <adm:user-friendly-name />
      to which the Directory Server should try to connect at startup
      time.
    </adm:synopsis>
    <adm:description>
      Addresses must be specified using the syntax: hostname:port
    </adm:description>
    <adm:syntax>
      <adm:string>
        <adm:pattern>
          <adm:regex>^.+:[0-9]+$</adm:regex>
          <adm:usage>HOST:PORT</adm:usage>
          <adm:synopsis>
            A host name followed by a ":" and a port number.
          </adm:synopsis>
        </adm:pattern>
      </adm:string>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-replication-server</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="server-id" mandatory="true" read-only="true">
    <adm:synopsis>
      Specifies a unique identifier for the Directory Server within the
      <adm:user-friendly-name />.
    </adm:synopsis>
    <adm:description>
      Each Directory Server within the same
      <adm:user-friendly-name />
      must have a different server ID. A Directory Server which is a
      member of multiple
      <adm:user-friendly-plural-name />
      may use the same server ID for each of its
      <adm:user-friendly-name />
      configurations.
    </adm:description>
    <adm:syntax>
      <adm:integer lower-limit="1" upper-limit="65535"></adm:integer>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-server-id</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="base-dn" mandatory="true" read-only="true">
    <adm:synopsis>
      Specifies the base DN of the replicated data.
    </adm:synopsis>
    <adm:syntax>
      <adm:dn />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-base-dn</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="window-size" advanced="true">
    <adm:synopsis>
      Specifies the window size that the Directory Server will use when
      communicating with Replication Servers.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>100</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:integer />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-window-size</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="heartbeat-interval" advanced="true">
    <adm:synopsis>
      Specifies the heart-beat interval that the Directory Server will
      use when communicating with Replication Servers.
    </adm:synopsis>
    <adm:description>
      The Directory Server expects a regular heart-beat coming from
      the Replication Server within the specified interval. If a
      heartbeat is not received within the interval, the Directory
      Server closes its connection and connects to another
      Replication Server.
    </adm:description>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>1000ms</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:duration base-unit="ms" lower-limit="100" />
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-heartbeat-interval</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
  <adm:property name="isolation-policy">
    <adm:synopsis>
      Specifies the behavior of the Directory Server if a write
      operation is attempted on the data within the
      <adm:user-friendly-name />
      when none of the configured Replication Servers are available.
    </adm:synopsis>
    <adm:default-behavior>
      <adm:defined>
        <adm:value>reject-all-updates</adm:value>
      </adm:defined>
    </adm:default-behavior>
    <adm:syntax>
      <adm:enumeration>
        <adm:value name="accept-all-updates">
          <adm:synopsis>
            Indicates that updates should be accepted even though it is
            not possible to send them to any Replication Server. Best
            effort is made to re-send those updates to a
            Replication Servers when one of them is available, however
            those changes are at risk because they are only 
            available from the historical information. This mode can
            also introduce high replication latency.
          </adm:synopsis>
        </adm:value>
        <adm:value name="reject-all-updates">
          <adm:synopsis>
            Indicates that all updates attempted on this
            <adm:user-friendly-name />
            are rejected when no Replication Server is available.
          </adm:synopsis>
        </adm:value>
      </adm:enumeration>
    </adm:syntax>
    <adm:profile name="ldap">
      <ldap:attribute>
        <ldap:name>ds-cfg-isolation-policy</ldap:name>
      </ldap:attribute>
    </adm:profile>
  </adm:property>
</adm:managed-object>
